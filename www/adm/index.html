@main[]
^page[]

@greeting[] 
Администрирование новостей 

@body_main[] 
$now[^date::now[]] 
<center> 
<form action="" method="POST"  enctype="multipart/form-data"> 
<p> 
Date: <input name="date" value="${now.year}-${now.month}-${now.day}"> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Header: <input name="header"> 
</p> 
<p>Body:<br /> 
<textarea cols="50" name="body" rows="5"></textarea> 
</p> 
<p> 
<input class="btn btn-success" type="submit" id="submitForm" value="Add New" name="posted">&nbsp;&nbsp;&nbsp; 
<input class="btn btn-default" type="reset" value="Cancel"> <br>
<input class="btn btn-danger" type="button" id="getNews" value="Получить новости"><br>
<select name="sidebarPosition">
	<option value="left">to the left</option>
	<option value="right">to the right</option>
</select><br>
<input type="file" name="photo" class="btn btn-warning" />
</p> 
</form> 
^if(def $form:date && def $form:header && def $form:body && def $form:photo){ 
   ^form:photo.save[binary;/upload/photos/^file:justname[$form:photo.name].^file:justext[$form:photo.name]] 

   ^connect[$connect_string]{ 
      ^void:sql{insert into news 
         (date, header, body, position, photo) 
      values  
         ('$form:date', '$form:header', '$form:body', '$form:sidebarPosition', '/upload/photos/^file:justname[$form:photo.name].^file:justext[$form:photo.name]') 
      } 
      …сообщение добавлено 
      } 
}{ 
   …не добавлено ничего
} 
</center> 